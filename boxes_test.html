<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="2560" height="1600"></canvas>
</body>
<script>
    var canvas = document.getElementById("gameCanvas");
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "#333333";
    ctx.fillRect(0, 0, 2560, 1600);
    ctx.fillStyle = "#FF474C";
    ctx.fillRect(1230, 750, 100, 100)
    var playerX = 100;
    var playerY = 1400;
    ctx.fillStyle = "#000000";
    ctx.fillRect(1000, 1000, 200, 200);
    function redraw() {
        box1.x = boxX;
        box1.y = boxY;
        ctx.fillStyle = "#333333";
        ctx.fillRect(0, 0, 2560, 1600);
        ctx.fillStyle = "#FF474C";
        ctx.fillRect(playerX, playerY, 100, 100)
        ctx.fillStyle = "#000000";
        collisionBoxes.forEach(function(box) {
            ctx.fillRect(box.x, box.y, box.width, box.height);
        });
        ctx.fillStyle = "#964B00";
        ctx.fillRect(boxX, boxY, 100, 100);
        ctx.fillStyle = "#FFFF00";
        ctx.fillRect(functionBoxTest.x, functionBoxTest.y, functionBoxTest.width, functionBoxTest.height);    
        
    };
    var aDown = false;
    var dDown = false;
    var wDown = false;
    var sDown = false;
    var boxX = 5000;
    var boxY = 5000;
    var level = 0;
    class CollisionBox {
        constructor(x, y, width, height) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
        }
    }
    class PushBox {
        constructor(x, y, width, height) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
        }
    }
    class functionBox {
        constructor(x, y, width, height, func) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            this.func = func;
        }
    }
    function isColliding()  {
        var things = [];
        var amount = 0;
        collisionBoxes.forEach(function(box) {
            amount += 1;
            things.push(((playerX > box.x - 100) &&
                        (playerX < box.x + box.width) &&
                        (playerY > box.y - 100) &&
                        (playerY < box.y + box.height)));
            
        });
        if (things.includes(true)) {
            return true;
        } else {
            return false;
        }
    };
    var wallLeft = new CollisionBox(0, 0, 100, 1600);
    var wallRight = new CollisionBox(2460, 0, 100, 1600);
    var wallTop = new CollisionBox(0, 0, 2560, 100);
    var wallBottom = new CollisionBox(0, 1500, 2560, 100);
    var MazeWall1 = new CollisionBox(200, 200, 100, 2000);
    var MazeWall2 = new CollisionBox(400, 100, 100, 1300);
    var MazeWall3 = new CollisionBox(500, 1300, 1860, 100);
    var MazeWall4 = new CollisionBox(600, 1100, 1860, 100);
    var MazeWall5 = new CollisionBox(600, 100, 100, 900);
    var MazeWall6 = new CollisionBox(700, 900, 1660, 100);
    var MazeWall7 = new CollisionBox(700, 700, 1660, 100);
    var MazeWall8 = new CollisionBox(2260, 200, 100, 600);
    var MazeWall9 = new CollisionBox(800, 200, 1460, 100);
    var MazeWall10 = new CollisionBox(800, 400, 1360, 200);
    var MazeWall11 = new CollisionBox(800, 300, 100, 100);
    var functionBoxTest = new functionBox(900, 300, 100, 100, function() {
        redraw();

        if (level == 1) {
            alert("You win!");
            aDown = false;
            dDown = false;
            wDown = false;
            sDown = false;

        } else {
            playerX = 100;
            playerY = 1400;
            boxX = 5000;
            boxY = 5000;
            aDown = false;
            dDown = false;
            wDown = false;
            sDown = false;
            collisionBoxes = [wallLeft, wallRight, wallTop, wallBottom, MazeWall1, MazeWall2, MazeWall3, MazeWall4, MazeWall5, MazeWall6, MazeWall7, MazeWall8, MazeWall9, MazeWall10, MazeWall11]
            alert("Next Level!");
            level += 1;
            redraw();
        }
    });
    var box1 = new PushBox(boxX, boxY, 100, 100);
    collisionBoxes = [wallLeft, wallRight, wallTop, wallBottom];
    document.addEventListener('keyup', function(event) {
        if (event.key === 'a' || event.key === 'A') {
            aDown = false;
            redraw();
        }
        if (event.key === 'd' || event.key === 'D') {
            dDown = false;
            redraw();
        }
        if (event.key === 'w' || event.key === 'W') {
            wDown = false;
            redraw();
        }
        if (event.key === 's' || event.key === 'S') {
            sDown = false;
            redraw();
        }
    });
    document.addEventListener('keydown', function(event) {
        if (event.key === 'a' || event.key === 'A') {
            aDown = true;
            redraw();
        }
        if (event.key === 'd' || event.key === 'D') {
            dDown = true;
            redraw();
        }
        if (event.key === 'w' || event.key === 'W') {
            wDown = true;
            redraw();
        }
        if (event.key === 's' || event.key === 'S') {
            sDown = true;
            redraw();
        }
        if (event.key === 'ArrowLeft') {
            playerX -= 10;
            redraw();
        }
        if (event.key === 'ArrowRight') {
            playerX += 10;
            redraw();
        }
        if (event.key === 'ArrowUp') {
            playerY -= 10;
            redraw();
        }
        if (event.key === 'ArrowDown') {
            playerY += 10;
            redraw();
        }
    });
    setInterval(function() {
        if (aDown) {
            playerX -= 10;
            while (isColliding()) {
                playerX += 10;

            }
            if (playerX > boxX - 100 && playerX < boxX + 100 && playerY > boxY - 100 && playerY < boxY + 100) {
                var X = boxX;
                boxX -= 10;
                while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                    boxX += 10;
                }
                if (X == boxX) {
                    playerX += 10;
                }

            }
            while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                boxX += 10;
            }
            if (playerX === functionBoxTest.x && playerY === functionBoxTest.y) {
                redraw();
                functionBoxTest.func();
            }
            
            
        }
        if (dDown) {
            playerX += 10;
            while ((isColliding())) {
                playerX -= 10;
            }
            if (playerX > boxX - 100 && playerX < boxX + 100 && playerY > boxY - 100 && playerY < boxY + 100) {
                var X = boxX;
                boxX += 10;
                while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                    boxX -= 10;
                }
                if (X == boxX) {
                    playerX -= 10;
                }
            }
            while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                boxX -= 10;
            }
            if (playerX === functionBoxTest.x && playerY === functionBoxTest.y) {
                redraw();
                functionBoxTest.func();
            }
        }
        if (wDown) {
            playerY -= 10;
            while (isColliding()) {
                playerY += 10;
            }
            if (playerX > boxX - 100 && playerX < boxX + 100 && playerY > boxY - 100 && playerY < boxY + 100) {
                var Y = boxY;
                boxY -= 10;
                while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                    boxY += 10;
                }
                if (Y == boxY) {
                    playerY += 10;
                }
            }
            while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                boxY += 10;
            }
            if (playerX === functionBoxTest.x && playerY === functionBoxTest.y) {
                redraw();
                functionBoxTest.func();
            }
        }
        if (sDown) {
            playerY += 10;
            while (isColliding()) {
                playerY -= 10;
            }
            if (playerX > boxX - 100 && playerX < boxX + 100 && playerY > boxY - 100 && playerY < boxY + 100) {
                var Y = boxY;
                boxY += 10;
                while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                    boxY -= 10;
                }
                if (Y == boxY) {
                    playerY -= 10;
                }
            }
            while (boxX > 900 && boxX < 1200 && boxY > 900 && boxY < 1200 || (boxX > 100 && boxX < 300 && boxY > 1300 && boxY < 1500)) {
                boxY -= 10;
            }
            if (playerX === functionBoxTest.x && playerY === functionBoxTest.y) {
                redraw();
                functionBoxTest.func();
            }
        }

        redraw();
    }, 30);
    redraw();

</script>
</html>